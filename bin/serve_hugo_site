#!/usr/bin/env bash

# ======================================================================================
#
#         FILE:  /serve_hugo_site
#
#        USAGE:  ./serve_hugo_site
#
#  DESCRIPTION:  Publish preview hugo site and ask to overtake if port 1313 is in use.
#
#      OPTIONS:  ---
# REQUIREMENTS:  ---
#         BUGS:  ---
#        NOTES:  ---
#       AUTHOR:  Duke Mai <henryfromvietnam@gmail.com>
#      COMPANY:  ---
#      VERSION:  2.0
#      CREATED:  May 02, 2023
#     REVISION:  ---
#
# ======================================================================================


set -eu

source "${DOTFILES}"/bash/functions

hugoserver () {
  hugo server \
    --buildDrafts \
    --buildExpired \
    --buildFuture \
    --disableFastRender \
    --forceSyncStatic \
    --navigateToChanged
}

if ! [[ -f ".hugo_build.lock" ]]; then
  log_error "Not in the root of a Hugo project"
  exit 1
elif ! [[ $# -eq 0 ]]; then
  log_error "Not accept any argument"
  exit 1
else
  hugoserver
fi
